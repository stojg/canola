{
  "version": 3,
  "sources": ["/Users/stojg/Sites/canola/src/lib/model.ts"],
  "sourcesContent": ["import { glMatrix, mat4, vec3 } from 'gl-matrix'\nimport type { Material } from './material'\nimport type REGL from 'regl'\nimport type { Controller } from './controller'\nimport { NullController } from './controller'\n\nexport interface ModelUniforms {\n  model: mat4\n  albedo: vec3\n  metallic: number\n  roughness: number\n  ao: number\n}\n\nexport class Model {\n  private _model: mat4\n  private material: Material\n  private controller: Controller | null\n\n  constructor(mtrl: Material, pos: vec3, scale: number, deg: number = 0, rotAxis: vec3 = [0, 1, 0], ctrl: Controller = new NullController()) {\n    this.material = mtrl\n    this._model = Model.createModel(pos, scale, deg, rotAxis)\n    this.controller = ctrl\n  }\n\n  update() {\n    if (this.controller != null) {\n      this.controller.update(this)\n    }\n  }\n\n  get model(): mat4 {\n    return this._model\n  }\n\n  set model(value: mat4) {\n    this._model = value\n  }\n\n  get albedo() {\n    return this.material.albedo\n  }\n\n  get ao() {\n    return this.material.ao\n  }\n\n  get metallic() {\n    return this.material.metallic\n  }\n\n  get roughness() {\n    return this.material.roughness\n  }\n\n  static uniforms(regl: REGL.Regl) {\n    return {\n      model: regl.prop<ModelUniforms, 'model'>('model'),\n      albedo: regl.prop<ModelUniforms, 'albedo'>('albedo'),\n      metallic: regl.prop<ModelUniforms, 'metallic'>('metallic'),\n      roughness: regl.prop<ModelUniforms, 'roughness'>('roughness'),\n      ao: regl.prop<ModelUniforms, 'ao'>('ao'),\n    }\n  }\n\n  private static createModel(position: vec3, scale: number, deg: number = 0, rotAxis: vec3 = [0, 1, 0]): mat4 {\n    const translation = mat4.identity(new Float32Array(16))\n    mat4.translate(translation, translation, position)\n    mat4.rotate(translation, translation, glMatrix.toRadian(deg), rotAxis)\n    mat4.scale(translation, translation, [scale, scale, scale])\n    return translation\n  }\n}\n"],
  "mappings": "AAAA;AAIA;AAJA;AAAA,EAmBE,YAAY,wBAAwD,aAAmB,CAAC,GAAG,GAAG,WAAuB,IAAI;AACvH,SAAK,WAAW;AAChB,SAAK,SAAS,MAAM,YAAY,KAAK,OAAO,KAAK;AACjD,SAAK,aAAa;AAAA;AAAA,EAGpB;AACE,QAAI,KAAK,cAAc;AACrB,WAAK,WAAW,OAAO;AAAA;AAAA;AAAA,MAIvB;AACF,WAAO,KAAK;AAAA;AAAA,MAGV;AACF,SAAK,SAAS;AAAA;AAAA,MAGZ;AACF,WAAO,KAAK,SAAS;AAAA;AAAA,MAGnB;AACF,WAAO,KAAK,SAAS;AAAA;AAAA,MAGnB;AACF,WAAO,KAAK,SAAS;AAAA;AAAA,MAGnB;AACF,WAAO,KAAK,SAAS;AAAA;AAAA,SAGhB;AACL,WAAO;AAAA,MACL,OAAO,KAAK,KAA6B;AAAA,MACzC,QAAQ,KAAK,KAA8B;AAAA,MAC3C,UAAU,KAAK,KAAgC;AAAA,MAC/C,WAAW,KAAK,KAAiC;AAAA,MACjD,IAAI,KAAK,KAA0B;AAAA;AAAA;AAAA,SAIxB,mCAAyD,aAAmB,CAAC,GAAG,GAAG;AAChG,wBAAoB,KAAK,SAAS,IAAI,aAAa;AACnD,SAAK,UAAU,aAAa,aAAa;AACzC,SAAK,OAAO,aAAa,aAAa,SAAS,SAAS,MAAM;AAC9D,SAAK,MAAM,aAAa,aAAa,CAAC,OAAO,OAAO;AACpD,WAAO;AAAA;AAAA;",
  "names": []
}
