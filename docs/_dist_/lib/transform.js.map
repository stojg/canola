{
  "version": 3,
  "sources": ["/Users/stojg/Sites/canola/src/lib/transform.ts"],
  "sourcesContent": ["import { mat4, quat, vec3 } from 'gl-matrix'\n\nexport interface TransformProperties {\n  position?: vec3\n  rotation?: quat\n  scale?: vec3\n}\n\nexport class Transform {\n  private _position: vec3\n  private _rotation: quat\n  private _scale: vec3\n  private _transformation: mat4 = mat4.create()\n  private dirty: boolean = true\n\n  constructor(props: TransformProperties) {\n    mat4.identity(this._transformation)\n    this._position = props.position || vec3.create()\n    this._rotation = props.rotation || quat.create()\n    this._scale = props.scale || vec3.fromValues(1, 1, 1)\n  }\n\n  get position(): vec3 {\n    return this._position\n  }\n\n  set position(value: vec3) {\n    this._position = value\n    this.dirty = true\n  }\n\n  addPosition(a: vec3) {\n    vec3.add(this._position, this._position, a)\n    this.dirty = true\n  }\n\n  get rotation(): quat {\n    return this._rotation\n  }\n\n  set rotation(value: quat) {\n    this._rotation = value\n    this.dirty = true\n  }\n\n  // stable XY rotation that avoids 'creeping' roll\n  rotateXY(x: number, y: number) {\n    // Pitch Locally, Yaw Globally\n    const tmp = quat.create()\n    quat.setAxisAngle(tmp, [0, 1, 0], x)\n    quat.mul(this.rotation, tmp, this.rotation)\n    quat.setAxisAngle(tmp, [1, 0, 0], y)\n    quat.mul(this.rotation, this.rotation, tmp)\n    this.dirty = true\n  }\n\n  get scale(): vec3 {\n    return this._scale\n  }\n\n  set scale(value: vec3) {\n    this._scale = value\n    this.dirty = true\n  }\n\n  get transformation(): mat4 {\n    return this._transformation\n  }\n\n  update() {\n    if (!this.dirty) {\n      return\n    }\n    mat4.fromRotationTranslationScale(this._transformation, this._rotation, this._position, this._scale)\n    quat.normalize(this.rotation, this.rotation)\n    this.dirty = false\n  }\n}\n"],
  "mappings": "AAAA;AAAA;AAAA,EAeE,YAAY;AAHJ,2BAAwB,KAAK;AAC7B,iBAAiB;AAGvB,SAAK,SAAS,KAAK;AACnB,SAAK,YAAY,MAAM,YAAY,KAAK;AACxC,SAAK,YAAY,MAAM,YAAY,KAAK;AACxC,SAAK,SAAS,MAAM,SAAS,KAAK,WAAW,GAAG,GAAG;AAAA;AAAA,MAGjD;AACF,WAAO,KAAK;AAAA;AAAA,MAGV;AACF,SAAK,YAAY;AACjB,SAAK,QAAQ;AAAA;AAAA,EAGf;AACE,SAAK,IAAI,KAAK,WAAW,KAAK,WAAW;AACzC,SAAK,QAAQ;AAAA;AAAA,MAGX;AACF,WAAO,KAAK;AAAA;AAAA,MAGV;AACF,SAAK,YAAY;AACjB,SAAK,QAAQ;AAAA;AAAA,EAIf;AAEE,gBAAY,KAAK;AACjB,SAAK,aAAa,KAAK,CAAC,GAAG,GAAG,IAAI;AAClC,SAAK,IAAI,KAAK,UAAU,KAAK,KAAK;AAClC,SAAK,aAAa,KAAK,CAAC,GAAG,GAAG,IAAI;AAClC,SAAK,IAAI,KAAK,UAAU,KAAK,UAAU;AACvC,SAAK,QAAQ;AAAA;AAAA,MAGX;AACF,WAAO,KAAK;AAAA;AAAA,MAGV;AACF,SAAK,SAAS;AACd,SAAK,QAAQ;AAAA;AAAA,MAGX;AACF,WAAO,KAAK;AAAA;AAAA,EAGd;AACE,QAAI,CAAC,KAAK;AACR;AAAA;AAEF,SAAK,6BAA6B,KAAK,iBAAiB,KAAK,WAAW,KAAK,WAAW,KAAK;AAC7F,SAAK,UAAU,KAAK,UAAU,KAAK;AACnC,SAAK,QAAQ;AAAA;AAAA;",
  "names": []
}
